%!PS-Adobe

%----- Customizable values (point = 1/72 inch) -----

/SheetWidth 1306.77 def
/MarginRight 4.25197 def
/CutMarkLeftPos 26.9291 def  % points from right edge of the sheet

%----- End of Customizable values -----

% ----- variables -----
/MarkAreaHeight 28.35 def
/CueMarkSize 14.17 def
/RefreshBarWidth 0.48 def

/RefreshBarLength SheetWidth CueMarkSize sub MarginRight sub MarginRight sub def
/RefreshBarPitch 2.8 def
/CutMarkWidth 22.68 def
/CutMarkHeight 5.67 def


% ----- procedures -----
% [DrawBar] Draw a refresh bar from currentpoint
% colornumber DrawBar -
% colornumber: 0=cyan, 1=magenta, 2=yellow, 3=black
/DrawBar
{
  1 0 0 0 5 -1 roll 4 exch roll setcmykcolor
  RefreshBarWidth setlinewidth
  RefreshBarLength 0 rlineto
  stroke
} bind def

% [DrawBars] Draw refresh bars for each process colors from currentpoint
% - DrawBars -
/DrawBars
{
  gsave
  currentpoint /cy exch def /cx exch def
  0 1 3 {
    dup RefreshBarPitch mul cy exch sub cx exch moveto
    DrawBar
  } for
  grestore
} bind def

% page drawing start
% first page for front surface
<< /PageSize [ SheetWidth MarkAreaHeight ] >> setpagedevice
MarginRight MarkAreaHeight 0 sub RefreshBarPitch sub moveto
DrawBars
gsave
false setoverprint
0 0 0 0 setcmykcolor
SheetWidth CutMarkLeftPos sub MarkAreaHeight 0 sub CueMarkSize RefreshBarWidth RefreshBarPitch add 4 mul neg rectfill
grestore
showpage
% second page for back surface
/RefreshBarLength SheetWidth MarginRight sub MarginRight sub def
<< /PageSize [ SheetWidth MarkAreaHeight ] >> setpagedevice
MarginRight MarkAreaHeight 0 sub RefreshBarPitch sub moveto
DrawBars
showpage
